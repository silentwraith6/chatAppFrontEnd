(this["webpackJsonpfrontend-chat-application"]=this["webpackJsonpfrontend-chat-application"]||[]).push([[0],{133:function(e,t){},136:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(8),i=a.n(r),s=(a(96),a(83)),l=a(34),c=a(35),m=a(41),u=a(40),d=a(20),p=a(4),g=a(137),h=a(163),f=a(164),b=a(165),v=a(166),y=a(167),x=a(169),E=a(168),w=a(77),N=a.n(w),k=a(82),C=a.n(k),S=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var o;Object(l.a)(this,a),(o=t.call(this,e)).autoScrolling=function(){var e=document.getElementById("msgList").lastElementChild,t=getComputedStyle(e),a=parseInt(t.marginBottom),n=e.offsetHeight+a,r=document.getElementById("chatList"),i=r.offsetHeight,s=r.scrollHeight,l=r.scrollTop+i;console.log("container Height =",s,"\nnew message Height =",n,"\nscrollOffset =",l),Math.floor(s-n-2)<=Math.ceil(l)?r.scrollTop=r.scrollHeight+a:o.setState({showFab:!0})},o.addMessage=function(e){o.setState({messages:[].concat(Object(s.a)(o.state.messages),[e])}),sessionStorage.setItem("state",JSON.stringify(o.state)),o.autoScrolling()};var n=!1;return o.props.location.state&&o.props.location.state.userName&&o.props.location.state.roomName&&o.props.location.state.msg&&(n=!0),o.state=sessionStorage.getItem("state")?JSON.parse(sessionStorage.getItem("state")):{userName:n?o.props.location.state.userName:"",messages:n?[o.props.location.state.msg]:[],roomName:n?o.props.location.state.roomName:"",userJoined:n,status:null,showFab:!1},o.props.socket.emit("join",{userName:o.state.userName,roomName:o.state.roomName},(function(e){})),o}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.getElementById("chatList");this.props.socket.on("serverToClientMessage",(function(t,a){t.recOnClientAt=(new Date).getTime(),t.status="recOnClient",e.addMessage(t)})),window.addEventListener("offline",(function(){e.setState({status:"disconnected"})})),window.addEventListener("online",(function(){e.setState({status:"connected"}),e.props.socket.emit("updateMessages",e.state.messages[e.state.messages.length-1].id,e.state.roomName,(function(t){alert("missed "+t.length),t.map((function(t){e.addMessage(t)})),window.location.reload(!1)}))}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes;t.theme;return this.state.userJoined?n.a.createElement(g.a,{className:a.rootCont},n.a.createElement(h.a,{style:{height:"11%",backgroundColor:"#5A5890"}},n.a.createElement(f.a,{style:{color:"white",fontSize:"22px",fontFamily:"cursive",marginLeft:"10px",display:"flex",height:"100%",alignItems:"center"}},"Room Name : ",this.state.roomName,n.a.createElement("br",null),"Participant Name : ",this.state.userName)),n.a.createElement(g.a,{id:"chatList",className:a.msgDisplay,style:{}},n.a.createElement(b.a,{id:"msgList",style:{bottom:"0",width:"100%",height:"100%",overflow:"auto"}},this.state.messages.map((function(t){return n.a.createElement(v.a,{className:t.senderName===e.state.userName?a.ownMessage:"admin"===t.senderName?a.adminMessage:a.otherMessage},n.a.createElement("div",{style:{maxWidth:"243px"}},t.senderName!==e.state.userName&&"admin"!==t.senderName?n.a.createElement("div",{style:{color:"orange",fontSize:"15px"}},t.senderName):null,"admin"===t.senderName?n.a.createElement("div",{style:{color:"black",fontSize:"16px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.5",wordWrap:"break-word"}},t.message):n.a.createElement("div",{style:{color:"white",fontSize:"18px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.5",wordWrap:"break-word"}},t.message),"admin"===t.senderName?null:n.a.createElement("div",{style:{color:"white",textAlign:"end",fontSize:"16px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.43"}},N()(t.createdAt).format("h:mm a"))))}))),n.a.createElement(y.a,{className:this.state.showFab?a.fabVisible:a.fabHidden,size:"small"},n.a.createElement(C.a,null))),n.a.createElement("form",{style:{height:"10%",minWidth:"300px",textAlign:"center",maxWidth:"720px"}},n.a.createElement(x.a,{className:a.inputRoot,InputProps:{className:a.inputInput},margin:"normal",variant:"filled",required:!0,id:"msg",label:"Type your message",color:"primary",autoFocus:!0,style:{width:"70%"}}),n.a.createElement(E.a,{type:"submit",id:"send",variant:"contained",color:"primary",style:{marginLeft:"20px",marginBottom:"20px",verticalAlign:"bottom",backgroundColor:"#298c18"},onClick:function(t){t.preventDefault();var a={message:document.getElementById("msg").value,senderName:e.state.userName,status:"sentFromClient",sentFromClientAt:(new Date).getTime()};document.getElementById("msg").value="",e.props.socket.emit("clientToServerMessage",a,(function(e){console.log(e)}))}},"Send"))):n.a.createElement("div",null,alert("You need to join a room first"),n.a.createElement(d.a,{to:"/join"}))}}]),a}(o.Component),W=Object(p.a)((function(e){return{rootCont:{maxWidth:"720px",margin:"0 auto",boxShadow:"none",backgroundColor:"#5A5890",height:"100%"},msgDisplay:{minWidth:"300px",height:"77%",margin:"0 auto",overflowY:"hidden",position:"relative",backgroundColor:"#ebebfc"},ownMessage:{marginRight:"12px",backgroundColor:"#514f82",marginBottom:"5px",borderRadius:"16px",maxWidth:"275px",width:"fit-content",right:"0",float:"right",clear:"both",borderTopRightRadius:"0px"},otherMessage:{marginLeft:"12px",backgroundColor:"#5511a8",float:"left",clear:"both",marginBottom:"5px",borderRadius:"16px",maxWidth:"275px",width:"fit-content",borderTopLeftRadius:"0px"},adminMessage:{width:"fit-content",maxWidth:"275px",marginBottom:"5px",backgroundColor:"#8684b5",margin:"5px auto",padding:"0px 6px",opacity:"0.8",borderRadius:"8px",clear:"both"},inputRoot:{backgroundColor:"#d4d3f0"},inputInput:{color:"black"},fabVisible:{backgroundColor:"#8684b5",opacity:"0.8",bottom:"20px",right:"60px",position:"absolute"},fabHidden:{display:"none"}}}),{withTheme:!0})(S),j=a(50),I=a.n(j),O=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes;t.theme;return n.a.createElement("div",{style:{backgroundColor:"#fff",display:"flex"}},n.a.createElement(g.a,{className:a.rootCont},n.a.createElement(f.a,{style:{fontSize:"40px",fontFamily:"cursive",color:"#fff"}},"Welcome to Manav's Chat Application"),n.a.createElement("br",null),n.a.createElement(f.a,{style:{fontSize:"20px",fontFamily:"cursive",color:"#fff"}},"Please enter details to join/create a chat room"),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("form",{stye:{marginTop:"auto",marginBottom:"auto"}},n.a.createElement(x.a,{className:a.inputRoot,InputProps:{className:a.inputInput},varient:"filled",margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Type your name",autoFocus:!0,color:"secondary",style:{maxWidth:"300px"}}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(x.a,{className:a.inputRoot,InputProps:{className:a.inputInput},margin:"normal",required:!0,fullWidth:!0,id:"roomName",label:"Type the room name",autoFocus:!0,color:"secondary",style:{maxWidth:"300px"}}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(E.a,{style:{backgroundColor:"#298c18"},type:"submit",variant:"contained",color:"primary",onClick:function(t){t.preventDefault();var a=document.getElementById("name").value,o=document.getElementById("roomName").value;return document.getElementById("name").value="",document.getElementById("roomName").value="",a=a.trim(),o=o.trim(),a&&o?(a=a.trim(),o=o.trim(),a&&o?"admin"===a?alert("Username not valid"):void e.props.socket.emit("join",{userName:a,roomName:o},(function(t){console.log(t),"object"===typeof t?e.props.history.push({pathname:"/chat",state:{userName:a,roomName:o,msg:t}}):alert(t)})):alert("Username and room are required")):alert("Username and room are required")}},"Enter Room"))))}}]),a}(o.Component),B=Object(p.a)((function(e){return{rootCont:{maxWidth:"720px",margin:"0px auto",boxShadow:"none",paddingTop:"20px",paddingBottom:"20px",backgroundColor:"#5A5890",textAlign:"center"},inputRoot:{backgroundColor:"#d4d3f0"},inputInput:{color:"black"}}}),{withTheme:!0})(O),R=a(33),T=I()("https://chat-app-server-mg.herokuapp.com/");var A=function(){return n.a.createElement(R.a,null,console.log(window.location.href),n.a.createElement(d.d,null,n.a.createElement(d.b,{exact:!0,path:"/join",render:function(e){return n.a.createElement(B,Object.assign({},e,{socket:T}))}}),n.a.createElement(d.b,{exact:!0,path:"/chat",render:function(e){return n.a.createElement(W,Object.assign({},e,{socket:T}))}}),n.a.createElement(d.a,{from:"/",to:"/join"})))},M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function F(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(n.a.createElement(A,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");M?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var o=a.headers.get("content-type");404===a.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):F(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):F(t,e)}))}}()},91:function(e,t,a){e.exports=a(136)},96:function(e,t,a){}},[[91,1,2]]]);
//# sourceMappingURL=main.6b6f4e2a.chunk.js.map