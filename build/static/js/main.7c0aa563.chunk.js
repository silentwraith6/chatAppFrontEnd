(this["webpackJsonpfrontend-chat-application"]=this["webpackJsonpfrontend-chat-application"]||[]).push([[0],{133:function(e,t){},136:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(8),s=n.n(r),i=(n(96),n(83)),l=n(34),c=n(35),m=n(41),d=n(40),u=n(20),g=n(4),p=n(137),h=n(163),f=n(164),b=n(165),v=n(166),y=n(167),E=n(168),w=n(170),x=n(169),N=n(77),S=n.n(N),k=n(82),C=n.n(k),O=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).removeFabOnScroll=function(){var e=document.getElementById("chatList");Math.ceil(e.scrollTop+e.offsetHeight)>=.99*e.scrollHeight&&(a.setState({showFab:!1,unreadCount:0}),sessionStorage.setItem("state",JSON.stringify(a.state)))},a.onOfflineEventListener=function(){a.setState({status:"disconnected"}),sessionStorage.setItem("state",JSON.stringify(a.state))},a.onOnlineEventListener=function(){a.setState({status:"connected"}),sessionStorage.setItem("state",JSON.stringify(a.state)),a.props.socket.emit("updateMessages",a.state.messages[a.state.messages.length-1].id,a.state.roomName,(function(e){alert("missed "+e.length),e.map((function(e){a.addMessage(e)})),window.location.reload(!1)}))},a.autoScrolling=function(){var e=document.getElementById("msgList").lastElementChild,t=getComputedStyle(e),n=parseInt(t.marginBottom),o=e.offsetHeight+n,r=document.getElementById("chatList"),s=r.offsetHeight,i=r.scrollHeight,l=r.scrollTop+s;if(Math.floor(.99*(i-o))<=Math.ceil(l)){if(a.state.unreadAdminMsg){var c=a.state.messages;c=c.filter((function(e){return"Unread Messages"!==e.message&&"admin"!==e.senderName})),a.setState({messages:c,unreadAdminMsg:!1}),sessionStorage.setItem("state",JSON.stringify(a.state))}r.scrollTo({top:r.scrollHeight,behavior:"smooth"})}else{if(0===a.state.unreadCount){var m=a.state.messages;m.splice(m.length-1,0,{message:"Unread Messages",senderName:"admin"}),a.setState({messages:m,unreadAdminMsg:!0}),sessionStorage.setItem("state",JSON.stringify(a.state))}a.setState({showFab:!0,unreadCount:a.state.unreadCount+1}),sessionStorage.setItem("state",JSON.stringify(a.state))}},a.scrollToBottom=function(){var e=document.getElementById("chatList");e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},a.addMessage=function(e){a.setState({messages:[].concat(Object(i.a)(a.state.messages),[e])}),sessionStorage.setItem("state",JSON.stringify(a.state)),a.autoScrolling()};var o=!1;return a.props.location.state&&a.props.location.state.userName&&a.props.location.state.roomName&&a.props.location.state.msg&&(o=!0),a.state=sessionStorage.getItem("state")?JSON.parse(sessionStorage.getItem("state")):{userName:o?a.props.location.state.userName:"",messages:o?[a.props.location.state.msg]:[],roomName:o?a.props.location.state.roomName:"",userJoined:o,status:null,showFab:!1,unreadCount:0,unreadAdminMsg:!1},a.props.socket.emit("join",{userName:a.state.userName,roomName:a.state.roomName},(function(e){})),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("chatList");t.scrollTop=t.scrollHeight,t.addEventListener("scroll",this.removeFabOnScroll),this.props.socket.on("serverToClientMessage",(function(t,n){t.recOnClientAt=(new Date).getTime(),t.status="recOnClient",e.addMessage(t)})),window.addEventListener("offline",this.onOfflineEventListener),window.addEventListener("online",(function(){return e.onOnlineEventListener}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("online",this.onOnlineEventListener),window.removeEventListener("offline",this.onOfflineEventListener),document.getElementById("chatList").removeEventListener("scroll",this.removeFabOnScroll),this.setState({status:null,showFab:!1,unreadCount:0,unreadAdminMsg:!1}),sessionStorage.setItem("state",JSON.stringify(this.state))}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes;t.theme;return this.state.userJoined?o.a.createElement(p.a,{className:n.rootCont},o.a.createElement(h.a,{style:{height:"11%",backgroundColor:"#5A5890"}},o.a.createElement(f.a,{style:{color:"white",fontSize:"22px",fontFamily:"cursive",marginLeft:"10px",display:"flex",height:"100%",alignItems:"center"}},"Room Name : ",this.state.roomName,o.a.createElement("br",null),"Participant Name : ",this.state.userName)),o.a.createElement(p.a,{className:n.msgDisplay,style:{}},o.a.createElement("div",{id:"chatList",style:{bottom:"0",width:"100%",height:"100%",overflow:"auto"}},o.a.createElement(b.a,{id:"msgList"},this.state.messages.map((function(t){return o.a.createElement(v.a,{className:t.senderName===e.state.userName?n.ownMessage:"admin"===t.senderName?n.adminMessage:n.otherMessage},o.a.createElement("div",{style:{maxWidth:"243px"}},t.senderName!==e.state.userName&&"admin"!==t.senderName?o.a.createElement("div",{style:{color:"orange",fontSize:"15px"}},t.senderName):null,"admin"===t.senderName?o.a.createElement("div",{style:{color:"black",fontSize:"16px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.5",wordWrap:"break-word"}},t.message):o.a.createElement("div",{style:{color:"white",fontSize:"18px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.5",wordWrap:"break-word"}},t.message),"admin"===t.senderName?null:o.a.createElement("div",{style:{color:"white",textAlign:"end",fontSize:"16px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.43"}},S()(t.createdAt).format("h:mm a"))))})))),o.a.createElement(y.a,{className:this.state.showFab?n.fabVisible:n.fabHidden,size:"small",onClick:function(){e.scrollToBottom(),e.setState({showFab:!1,unreadCount:0}),sessionStorage.setItem("state",JSON.stringify(e.state))}},o.a.createElement(E.a,{badgeContent:this.state.unreadCount,color:"secondary"},o.a.createElement(C.a,null)))),o.a.createElement("form",{style:{height:"10%",minWidth:"300px",textAlign:"center",maxWidth:"720px"}},o.a.createElement(w.a,{className:n.inputRoot,InputProps:{className:n.inputInput},margin:"normal",variant:"filled",required:!0,id:"msg",label:"Type your message",color:"primary",autoFocus:!0,style:{width:"70%"}}),o.a.createElement(x.a,{type:"submit",id:"send",variant:"contained",color:"primary",style:{marginLeft:"20px",marginBottom:"20px",verticalAlign:"bottom",backgroundColor:"#298c18"},onClick:function(t){t.preventDefault();var n={message:document.getElementById("msg").value,senderName:e.state.userName,status:"sentFromClient",sentFromClientAt:(new Date).getTime()};document.getElementById("msg").value="",e.props.socket.emit("clientToServerMessage",n,(function(e){console.log(e)}))}},"Send"))):o.a.createElement("div",null,alert("You need to join a room first"),o.a.createElement(u.a,{to:"/join"}))}}]),n}(a.Component),I=Object(g.a)((function(e){return{rootCont:{maxWidth:"720px",margin:"0 auto",boxShadow:"none",backgroundColor:"#5A5890",height:"100%"},msgDisplay:{minWidth:"300px",height:"77%",margin:"0 auto",overflowY:"hidden",position:"relative",backgroundColor:"#ebebfc"},ownMessage:{marginRight:"12px",backgroundColor:"#514f82",marginBottom:"5px",borderRadius:"16px",maxWidth:"275px",width:"fit-content",right:"0",float:"right",clear:"both",borderTopRightRadius:"0px"},otherMessage:{marginLeft:"12px",backgroundColor:"#5511a8",float:"left",clear:"both",marginBottom:"5px",borderRadius:"16px",maxWidth:"275px",width:"fit-content",borderTopLeftRadius:"0px"},adminMessage:{width:"fit-content",maxWidth:"275px",marginBottom:"5px",backgroundColor:"#8684b5",margin:"5px auto",padding:"0px 6px",opacity:"0.8",borderRadius:"8px",clear:"both"},inputRoot:{backgroundColor:"#d4d3f0"},inputInput:{color:"black"},fabVisible:{backgroundColor:"#8684b5",opacity:"0.8",bottom:"20px",right:"60px",position:"absolute"},fabHidden:{display:"none"}}}),{withTheme:!0})(O),W=n(50),L=n.n(W),M=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes;t.theme;return o.a.createElement("div",{style:{backgroundColor:"#fff",display:"flex"}},o.a.createElement(p.a,{className:n.rootCont},o.a.createElement(f.a,{style:{fontSize:"40px",fontFamily:"cursive",color:"#fff"}},"Welcome to Manav's Chat Application"),o.a.createElement("br",null),o.a.createElement(f.a,{style:{fontSize:"20px",fontFamily:"cursive",color:"#fff"}},"Please enter details to join/create a chat room"),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("form",{stye:{marginTop:"auto",marginBottom:"auto"}},o.a.createElement(w.a,{className:n.inputRoot,InputProps:{className:n.inputInput},varient:"filled",margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Type your name",autoFocus:!0,color:"secondary",style:{maxWidth:"300px"}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(w.a,{className:n.inputRoot,InputProps:{className:n.inputInput},margin:"normal",required:!0,fullWidth:!0,id:"roomName",label:"Type the room name",autoFocus:!0,color:"secondary",style:{maxWidth:"300px"}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(x.a,{style:{backgroundColor:"#298c18"},type:"submit",variant:"contained",color:"primary",onClick:function(t){t.preventDefault();var n=document.getElementById("name").value,a=document.getElementById("roomName").value;return document.getElementById("name").value="",document.getElementById("roomName").value="",n=n.trim(),a=a.trim(),n&&a?(n=n.trim(),a=a.trim(),n&&a?"admin"===n?alert("Username not valid"):void e.props.socket.emit("join",{userName:n,roomName:a},(function(t){console.log(t),"object"===typeof t?e.props.history.push({pathname:"/chat",state:{userName:n,roomName:a,msg:t}}):alert(t)})):alert("Username and room are required")):alert("Username and room are required")}},"Enter Room"))))}}]),n}(a.Component),j=Object(g.a)((function(e){return{rootCont:{maxWidth:"720px",margin:"0px auto",boxShadow:"none",paddingTop:"20px",paddingBottom:"20px",backgroundColor:"#5A5890",textAlign:"center"},inputRoot:{backgroundColor:"#d4d3f0"},inputInput:{color:"black"}}}),{withTheme:!0})(M),B=n(33),T=L()("https://chat-app-server-mg.herokuapp.com/");var A=function(){return o.a.createElement(B.a,null,console.log(window.location.href),o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:"/join",render:function(e){return o.a.createElement(j,Object.assign({},e,{socket:T}))}}),o.a.createElement(u.b,{exact:!0,path:"/chat",render:function(e){return o.a.createElement(I,Object.assign({},e,{socket:T}))}}),o.a.createElement(u.a,{from:"/",to:"/join"})))},F=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function R(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(o.a.createElement(A,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");F?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):R(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):R(t,e)}))}}()},91:function(e,t,n){e.exports=n(136)},96:function(e,t,n){}},[[91,1,2]]]);
//# sourceMappingURL=main.7c0aa563.chunk.js.map