(this["webpackJsonpfrontend-chat-application"]=this["webpackJsonpfrontend-chat-application"]||[]).push([[0],{132:function(e,t){},135:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(8),r=a.n(s),i=a(83),l=a(34),m=a(35),c=a(41),d=a(40),u=a(20),g=a(4),p=a(136),h=a(162),f=a(163),b=a(164),y=a(165),v=a(166),E=a(167),x=a(169),N=a(168),S=a(77),w=a.n(S),C=a(82),k=a.n(C),I=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).removeFabOnScroll=function(){var e=document.getElementById("chatList");Math.ceil(e.scrollTop+e.offsetHeight)>=.99*e.scrollHeight&&(n.setState({showFab:!1,unreadCount:0}),sessionStorage.setItem("state",JSON.stringify(n.state)))},n.onOfflineEventListener=function(){n.setState({status:"disconnected"}),sessionStorage.setItem("state",JSON.stringify(n.state))},n.onOnlineEventListener=function(){n.setState({status:"connected"}),sessionStorage.setItem("state",JSON.stringify(n.state)),n.props.socket.emit("updateMessages",n.state.messages[n.state.messages.length-1].id,n.state.roomName,(function(e){alert("missed "+e.length),e.map((function(e){n.addMessage(e)})),window.location.reload(!1)}))},n.autoScrolling=function(){var e=document.getElementById("msgList").lastElementChild,t=getComputedStyle(e),a=parseInt(t.marginBottom),o=e.offsetHeight+a,s=document.getElementById("chatList"),r=s.offsetHeight,i=s.scrollHeight,l=s.scrollTop+r;if(Math.floor(.99*(i-o))<=Math.ceil(l)){if(n.state.unreadAdminMsg){var m=n.state.messages;m=m.filter((function(e){return"Unread Messages"!==e.message&&"admin"!==e.senderName})),n.setState({messages:m,unreadAdminMsg:!1}),sessionStorage.setItem("state",JSON.stringify(n.state))}s.scrollTo({top:s.scrollHeight,behavior:"smooth"})}else{if(0===n.state.unreadCount){var c=n.state.messages;c.splice(c.length-1,0,{message:"Unread Messages",senderName:"admin"}),n.setState({messages:c,unreadAdminMsg:!0}),sessionStorage.setItem("state",JSON.stringify(n.state))}n.setState({showFab:!0,unreadCount:n.state.unreadCount+1}),sessionStorage.setItem("state",JSON.stringify(n.state))}},n.scrollToBottom=function(){var e=document.getElementById("chatList");e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},n.addMessage=function(e){n.setState({messages:[].concat(Object(i.a)(n.state.messages),[e])}),sessionStorage.setItem("state",JSON.stringify(n.state)),n.autoScrolling()};var o=!1;return n.props.location.state&&n.props.location.state.userName&&n.props.location.state.roomName&&n.props.location.state.msg&&(o=!0),n.state=sessionStorage.getItem("state")?JSON.parse(sessionStorage.getItem("state")):{userName:o?n.props.location.state.userName:"",messages:o?[n.props.location.state.msg]:[],roomName:o?n.props.location.state.roomName:"",userJoined:o,status:null,showFab:!1,unreadCount:0,unreadAdminMsg:!1},n.props.socket.emit("join",{userName:n.state.userName,roomName:n.state.roomName},(function(e){})),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("chatList");t.scrollTop=t.scrollHeight,t.addEventListener("scroll",this.removeFabOnScroll),this.props.socket.on("serverToClientMessage",(function(t,a){t.recOnClientAt=(new Date).getTime(),t.status="recOnClient",e.addMessage(t)})),window.addEventListener("offline",this.onOfflineEventListener),window.addEventListener("online",(function(){return e.onOnlineEventListener}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("online",this.onOnlineEventListener),window.removeEventListener("offline",this.onOfflineEventListener),document.getElementById("chatList").removeEventListener("scroll",this.removeFabOnScroll),this.setState({status:null,showFab:!1,unreadCount:0,unreadAdminMsg:!1}),sessionStorage.setItem("state",JSON.stringify(this.state))}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes;t.theme;return this.state.userJoined?o.a.createElement(p.a,{className:a.rootCont},o.a.createElement(h.a,{style:{height:"11%",backgroundColor:"#5A5890"}},o.a.createElement(f.a,{style:{color:"white",fontSize:"22px",fontFamily:"cursive",marginLeft:"10px",display:"flex",height:"100%",alignItems:"center"}},"Room Name : ",this.state.roomName,o.a.createElement("br",null),"Participant Name : ",this.state.userName)),o.a.createElement(p.a,{className:a.msgDisplay,style:{}},o.a.createElement("div",{id:"chatList",style:{bottom:"0",width:"100%",height:"100%",overflow:"auto"}},o.a.createElement(b.a,{id:"msgList"},this.state.messages.map((function(t){return o.a.createElement(y.a,{className:t.senderName===e.state.userName?a.ownMessage:"admin"===t.senderName?a.adminMessage:a.otherMessage},o.a.createElement("div",{style:{maxWidth:"243px"}},t.senderName!==e.state.userName&&"admin"!==t.senderName?o.a.createElement("div",{style:{color:"orange",fontSize:"15px"}},t.senderName):null,"admin"===t.senderName?o.a.createElement("div",{style:{color:"black",fontSize:"16px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.5",wordWrap:"break-word"}},t.message):o.a.createElement("div",{style:{color:"white",fontSize:"18px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.5",wordWrap:"break-word"}},t.message),"admin"===t.senderName?null:o.a.createElement("div",{style:{color:"white",textAlign:"end",fontSize:"16px",fontFamily:"roboto",fontWeight:"400",lineHeight:"1.43"}},w()(t.createdAt).format("h:mm a"))))})))),o.a.createElement(v.a,{className:this.state.showFab?a.fabVisible:a.fabHidden,size:"small",onClick:function(){e.scrollToBottom(),e.setState({showFab:!1,unreadCount:0}),sessionStorage.setItem("state",JSON.stringify(e.state))}},o.a.createElement(E.a,{badgeContent:this.state.unreadCount,color:"secondary"},o.a.createElement(k.a,null)))),o.a.createElement("form",{style:{height:"10%",minWidth:"300px",textAlign:"center",maxWidth:"720px"}},o.a.createElement(x.a,{className:a.inputRoot,InputProps:{className:a.inputInput},margin:"normal",variant:"filled",required:!0,id:"msg",label:"Type your message",color:"primary",autoFocus:!0,style:{width:"70%"}}),o.a.createElement(N.a,{type:"submit",id:"send",variant:"contained",color:"primary",style:{marginLeft:"20px",marginBottom:"20px",verticalAlign:"bottom",backgroundColor:"#298c18"},onClick:function(t){t.preventDefault();var a={message:document.getElementById("msg").value,senderName:e.state.userName,status:"sentFromClient",sentFromClientAt:(new Date).getTime()};document.getElementById("msg").value="",e.props.socket.emit("clientToServerMessage",a,(function(e){console.log(e)}))}},"Send"))):o.a.createElement("div",null,alert("You need to join a room first"),o.a.createElement(u.a,{to:"/join"}))}}]),a}(n.Component),O=Object(g.a)((function(e){return{rootCont:{maxWidth:"720px",margin:"0 auto",boxShadow:"none",backgroundColor:"#5A5890",height:"100%"},msgDisplay:{minWidth:"300px",height:"77%",margin:"0 auto",overflowY:"hidden",position:"relative",backgroundColor:"#ebebfc"},ownMessage:{marginRight:"12px",backgroundColor:"#514f82",marginBottom:"5px",borderRadius:"16px",maxWidth:"275px",width:"fit-content",right:"0",float:"right",clear:"both",borderTopRightRadius:"0px"},otherMessage:{marginLeft:"12px",backgroundColor:"#5511a8",float:"left",clear:"both",marginBottom:"5px",borderRadius:"16px",maxWidth:"275px",width:"fit-content",borderTopLeftRadius:"0px"},adminMessage:{width:"fit-content",maxWidth:"275px",marginBottom:"5px",backgroundColor:"#8684b5",margin:"5px auto",padding:"0px 6px",opacity:"0.8",borderRadius:"8px",clear:"both"},inputRoot:{backgroundColor:"#d4d3f0"},inputInput:{color:"black"},fabVisible:{backgroundColor:"#8684b5",opacity:"0.8",bottom:"20px",right:"60px",position:"absolute"},fabHidden:{display:"none"}}}),{withTheme:!0})(I),L=a(50),M=a.n(L),B=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e)}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes;t.theme;return o.a.createElement("div",{style:{backgroundColor:"#fff",display:"flex"}},o.a.createElement(p.a,{className:a.rootCont},o.a.createElement(f.a,{style:{fontSize:"40px",fontFamily:"cursive",color:"#fff"}},"Welcome to Manav's Chat Application"),o.a.createElement("br",null),o.a.createElement(f.a,{style:{fontSize:"20px",fontFamily:"cursive",color:"#fff"}},"Please enter details to join/create a chat room"),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("form",{stye:{marginTop:"auto",marginBottom:"auto"}},o.a.createElement(x.a,{className:a.inputRoot,InputProps:{className:a.inputInput},varient:"filled",margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Type your name",autoFocus:!0,color:"secondary",style:{maxWidth:"300px"}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(x.a,{className:a.inputRoot,InputProps:{className:a.inputInput},margin:"normal",required:!0,fullWidth:!0,id:"roomName",label:"Type the room name",autoFocus:!0,color:"secondary",style:{maxWidth:"300px"}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(N.a,{style:{backgroundColor:"#298c18"},type:"submit",variant:"contained",color:"primary",onClick:function(t){t.preventDefault();var a=document.getElementById("name").value,n=document.getElementById("roomName").value;return document.getElementById("name").value="",document.getElementById("roomName").value="",a=a.trim(),n=n.trim(),a&&n?(a=a.trim(),n=n.trim(),a&&n?"admin"===a?alert("Username not valid"):void e.props.socket.emit("join",{userName:a,roomName:n},(function(t){console.log(t),"object"===typeof t?e.props.history.push({pathname:"/chat",state:{userName:a,roomName:n,msg:t}}):alert(t)})):alert("Username and room are required")):alert("Username and room are required")}},"Enter Room"))))}}]),a}(n.Component),j=Object(g.a)((function(e){return{rootCont:{maxWidth:"720px",margin:"0px auto",boxShadow:"none",paddingTop:"20px",paddingBottom:"20px",backgroundColor:"#5A5890",textAlign:"center"},inputRoot:{backgroundColor:"#d4d3f0"},inputInput:{color:"black"}}}),{withTheme:!0})(B),F=a(33),T=M()("https://chatapp-backend-mg.herokuapp.com/");var W=function(){return o.a.createElement(F.a,null,console.log(window.location.href),o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:"/join",render:function(e){return o.a.createElement(j,Object.assign({},e,{socket:T}))}}),o.a.createElement(u.b,{exact:!0,path:"/chat",render:function(e){return o.a.createElement(O,Object.assign({},e,{socket:T}))}}),o.a.createElement(u.a,{from:"/",to:"/join"})))};r.a.render(o.a.createElement(W,null),document.getElementById("root"))},91:function(e,t,a){e.exports=a(135)}},[[91,1,2]]]);
//# sourceMappingURL=main.484ba05c.chunk.js.map